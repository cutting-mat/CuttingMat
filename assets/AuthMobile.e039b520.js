import{n as r,s as n,k as a,m as l}from"./index.16330bbd.js";import"./ui.3305e273.js";var u=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("el-form",{ref:"form",staticClass:"auth_mobile",attrs:{model:e.formData,rules:e.rules,"label-position":"left","v-loading":e.loading},nativeOn:{submit:function(i){return i.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[e.anonymousMobile?t("el-form-item",[e._v("\u7ED1\u5B9A\u624B\u673A\uFF1A"+e._s(e.anonymousMobile))]):e._e(),t("el-form-item",{attrs:{prop:"inputMobile"}},[t("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u7ED1\u5B9A\u624B\u673A","prefix-icon":"el-icon-message"},model:{value:e.formData.inputMobile,callback:function(i){e.$set(e.formData,"inputMobile",i)},expression:"formData.inputMobile"}})],1),t("el-form-item",{attrs:{prop:"userInput"}},[t("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},model:{value:e.formData.userInput,callback:function(i){e.$set(e.formData,"userInput",i)},expression:"formData.userInput"}},[t("CountdownButton",{ref:"countdownButton",attrs:{slot:"append",count:30},on:{click:e.sendValidCode},slot:"append"},[e._v(" \u83B7\u53D6\u9A8C\u8BC1\u7801 ")])],1)],1),t("el-form-item",[t("el-button",{staticStyle:{width:"100%"},attrs:{"native-type":"submit",type:"primary"}},[e._v(" \u7ACB\u5373\u9A8C\u8BC1 ")])],1)],1)},d=[];const m={props:{command:{type:String,required:!1}},data(){return{loading:!1,formData:{id:null,userInput:null,inputMobile:null},rules:{inputMobile:[{validator:(o,t,i)=>{if(!t)i(new Error("\u8BF7\u8F93\u5165\u7ED1\u5B9A\u624B\u673A"));else{if(this.userMobile&&this.userMobile!==t)return i(new Error("\u624B\u673A\u53F7\u4E0D\u6B63\u786E"));i()}},trigger:[]}],userInput:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",trigger:"blur"},{min:4,max:6,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u9A8C\u8BC1\u7801",trigger:"blur"}]}}},computed:{userMobile(){return String(this.$store.state.user.mobile||"")},anonymousMobile(){if(this.userMobile){const e=this.userMobile.split("");return`${e.map((t,i)=>i<3||e.length-i<3?t:"*").join("")}`}return""}},methods:{sendValidCode(){console.log("sendValidCode"),this.$refs.form.validateField("inputMobile",e=>{e||(this.loading=!0,(this.command==="reset-pw"?n:a)({mobile:this.formData.inputMobile}).then(t=>{this.loading=!1,t.status===200?(this.formData.id=t.data.id,this.$refs.countdownButton.start()):this.$message.warning("\u9A8C\u8BC1\u7801\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}).catch(()=>{this.loading=!1}))})},handleSubmit(){this.$refs.form.validateField("userInput",e=>{e||(this.loading=!0,l(this.formData).then(o=>{this.loading=!1,o.status===200?this.$emit("success",o.data):(this.$refs.form.resetFields(),this.$message.warning("\u9A8C\u8BC1\u5931\u8D25"))}).catch(()=>{this.loading=!1}))})}}},s={};var f=r(m,u,d,!1,p,"a976a788",null,null);function p(e){for(let o in s)this[o]=s[o]}var b=function(){return f.exports}();export{b as default};
