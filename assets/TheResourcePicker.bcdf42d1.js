import{n as c,b as l,t as u}from"./index.2024d5b4.js";import{r as d}from"./resource.c1cb51e0.js";import"./ui.a0367313.js";var h=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("el-tree",{ref:"tree",staticClass:"custom-tree",attrs:{data:e.list,props:e.defaultProps,"node-key":"id","default-expand-all":"","show-checkbox":e.picker,"check-strictly":""},on:{"check-change":e.handleCheckChange},scopedSlots:e._u([{key:"default",fn:function(i){var n=i.node,r=i.data;return t("div",{staticClass:"custom-tree-item"},[t("div",{staticClass:"flex-1 extendLable"},[r.type===1?t("span",{staticStyle:{color:"#67c23a"}},[t("i",{staticClass:"el-icon-medal"})]):e._e(),t("span",{class:{source:r.type===1},staticStyle:{"margin-right":"20px"}},[e._v(" "+e._s(r.name)+" ")]),r.type===1?t("el-tag",{attrs:{size:"small",type:e.typeColor[r.method]}},[t("i",{staticClass:"el-icon-position"}),e._v(" "+e._s(r.method.toUpperCase())+" ")]):e._e(),t("el-tag",{attrs:{size:"small",type:"info"}},[r.type===0?t("i",{staticClass:"el-icon-link"}):e._e(),e._v(" "+e._s(r.type===0?r.route:r.url)+" ")])],1),e.picker?t("span",{staticClass:"extendGroup"},[t("el-button",{attrs:{size:"small",type:"text"},on:{click:function(a){return a.stopPropagation(),e.handleCheckChange(r,!n.checked,!0)}}},[e._v(" \u6279\u91CF\u9009\u62E9 ")])],1):t("span",{staticClass:"extendGroup"},[t("el-button",{directives:[{name:"auth",rawName:"v-auth",value:e.resource.edit,expression:"resource.edit"}],attrs:{size:"small",type:"text"},on:{click:function(a){return a.stopPropagation(),e.$emit("edit",r)}}},[e._v(" \u7F16\u8F91 ")]),r.type===0?t("el-button",{directives:[{name:"auth",rawName:"v-auth",value:e.resource.add,expression:"resource.add"}],attrs:{size:"small",type:"text"},on:{click:function(a){return a.stopPropagation(),e.$emit("append",r)}}},[e._v(" \u6DFB\u52A0\u5B50\u83DC\u5355 ")]):e._e(),r.type===0?t("el-button",{directives:[{name:"auth",rawName:"v-auth",value:e.resource.add,expression:"resource.add"}],attrs:{size:"small",type:"text"},on:{click:function(a){return a.stopPropagation(),e.$emit("add-resource",r)}}},[e._v(" \u6DFB\u52A0\u8D44\u6E90 ")]):e._e(),t("el-button",{directives:[{name:"auth",rawName:"v-auth",value:e.resource.remove,expression:"resource.remove"}],attrs:{size:"small",type:"text"},on:{click:function(a){return a.stopPropagation(),e.$emit("remove",r)}}},[e._v(" \u5220\u9664 ")])],1)])}}])})},p=[];const m={model:{prop:"value",event:"change"},props:{picker:{type:Boolean,required:!1,default:!1},value:{type:Array,required:!1},listdata:{type:Array,required:!1}},data(){return{resource:d,list:[],defaultProps:{children:"children",label:"title"},typeColor:{get:"success",post:"primary",put:"warning",delete:"danger"},trigger:null}},watch:{listdata:{handler:function(e){Array.isArray(e)&&(this.list=e)},immediate:!0},value:{handler:function(){Array.isArray(this.value)&&this.$refs.tree.setCheckedKeys(this.value)},deep:!0}},methods:{handleCheckChange(e,s,t){const i=this.$refs.tree.getNode(e);i&&(this.$refs.tree.setChecked(i,s),t&&Array.isArray(e.children)&&e.children.length&&e.children.forEach(n=>{this.handleCheckChange(n,s,t)})),this.$nextTick(()=>{this.trigger()})},fetchData:function(){this.$store.action("permission").then(e=>{this.list=l(e.menus.concat(e.resources)),Array.isArray(this.value)&&this.$nextTick(()=>{this.$refs.tree.setCheckedKeys(this.value)})})}},created:function(){this.listdata||this.fetchData()},mounted(){this.trigger=u(()=>{const e=this.$refs.tree.getCheckedNodes();this.$emit("change",e.map(s=>s.id))})}},o={};var v=c(m,h,p,!1,f,"4bc8f9f4",null,null);function f(e){for(let s in o)this[s]=o[s]}var k=function(){return v.exports}();export{k as default};
