import{n as d,_ as n,d as s,b as m}from"./index.e94e32bd.js";import{r as i}from"./resource.337ee5b0.js";import"./ui.b381569e.js";var c=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"flex-col"},[t("ToolBar"),t("div",{staticClass:"flex-1 flex-row"},[t("div",{staticClass:"resourceWrap flex-1 scrollbar"},[t("TheResourcePicker",{attrs:{listdata:e.list},on:{edit:e.edit,append:e.append,"add-resource":e.addResource,remove:e.remove}})],1),t("el-form",{ref:"editForm",staticClass:"resourceEditFrom",attrs:{size:"small",rules:e.rules,model:e.editForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"\u540D\u79F0",prop:"name"}},[t("el-input",{attrs:{maxlength:100},model:{value:e.editForm.name,callback:function(r){e.$set(e.editForm,"name",typeof r=="string"?r.trim():r)},expression:"editForm.name"}})],1),e.editForm.type===1?t("el-form-item",{attrs:{label:"\u65B9\u6CD5",prop:"method"}},[t("el-radio-group",{model:{value:e.editForm.method,callback:function(r){e.$set(e.editForm,"method",r)},expression:"editForm.method"}},e._l(e.requestMethods,function(r,l){return t("el-radio",{key:"m"+l,attrs:{label:r.label.toLowerCase()}},[e._v(e._s(r.label))])}),1)],1):e._e(),e.editForm.type===1?t("el-form-item",{attrs:{label:"URL",prop:"url"}},[t("el-input",{model:{value:e.editForm.url,callback:function(r){e.$set(e.editForm,"url",typeof r=="string"?r.trim():r)},expression:"editForm.url"}})],1):t("el-form-item",{attrs:{label:"\u8DEF\u7531",prop:"route"}},[t("el-input",{attrs:{maxlength:100},model:{value:e.editForm.route,callback:function(r){e.$set(e.editForm,"route",typeof r=="string"?r.trim():r)},expression:"editForm.route"}})],1),t("el-form-item",{attrs:{label:"\u7236\u7EA7"}},[t("el-cascader",{attrs:{options:e.list,props:{checkStrictly:!0,label:"name",value:"id"}},model:{value:e.editForm.pid,callback:function(r){e.$set(e.editForm,"pid",r)},expression:"editForm.pid"}})],1),t("el-form-item",{attrs:{label:"\u5E8F\u53F7"}},[t("el-input",{attrs:{type:"number"},model:{value:e.editForm.orderNum,callback:function(r){e.$set(e.editForm,"orderNum",typeof r=="string"?r.trim():r)},expression:"editForm.orderNum"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("\u4FDD \u5B58")]),t("el-button",{on:{click:e.resetFrom}},[e._v("\u91CD \u7F6E")])],1)],1)],1)],1)},u=[];const p={components:{TheResourcePicker:()=>n(()=>import("./TheResourcePicker.0f34bcbb.js"),["assets/TheResourcePicker.0f34bcbb.js","assets/TheResourcePicker.8bc2573c.css","assets/index.e94e32bd.js","assets/index.cfd070ab.css","assets/ui.b381569e.js","assets/resource.337ee5b0.js"])},data(){return{resource:i,loading:!1,list:[],editForm:{pid:null,method:"get",name:"",url:"",type:0},rules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:"blur"},{min:1,max:100,message:"\u957F\u5EA6 1 \u5230 100 \u4E2A\u5B57\u7B26",trigger:"blur"}],url:[{required:!0,message:"\u8BF7\u8F93\u5165\u8DEF\u7531/URL",trigger:"blur"}],method:[{validator:(o,t,r)=>{if(this.editForm.type===1&&!t)return r(new Error("\u8BF7\u586B\u5199Method!"));r()},trigger:"blur"}]},requestMethods:[{label:"GET"},{label:"POST"},{label:"PUT"},{label:"DELETE"}]}},methods:{edit:function(e){this.editForm=s(e),this.editForm.method=this.editForm.method.toLowerCase()},append(e){this.editForm={pid:e.id,name:"",route:"",type:0}},addResource(e){this.editForm={pid:e.id,method:"get",name:"",url:"",type:1}},save(){this.$refs.editForm.validate(e=>{if(e){let o=s(this.editForm);const t=i;Array.isArray(o.pid)&&(o.pid=o.pid.pop()),o.method&&(o.method=o.method.toLowerCase()),this.loading=!0,(o.id?t.edit:t.add)(o).then(()=>{this.fetchData(),this.$message({message:"\u6DFB\u52A0\u6210\u529F",type:"success"})}).catch(()=>{this.loading=!1})}})},resetFrom:function(){this.editForm={pid:"",name:"",route:""},this.$refs.editForm&&this.$refs.editForm.resetFields()},remove(e){if(!e||!e.id)return null;const o=i;this.$confirm("\u662F\u5426\u5220\u9664?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{this.loading=!0,o.remove({id:e.id}).then(()=>{this.fetchData(),this.$message({message:"\u5220\u9664\u6210\u529F",type:"success"})}).catch(()=>{this.loading=!1})})},fetchData:function(){this.loading=!0,this.$store.action("permission",{cache:"update"}).then(e=>{this.loading=!1,this.list=m(e.menus.concat(e.resources))}).catch(()=>{this.loading=!1})}},created:function(){this.fetchData()}},a={};var h=d(p,c,u,!1,f,"24bd9045",null,null);function f(e){for(let o in a)this[o]=a[o]}var b=function(){return h.exports}();export{b as default};
