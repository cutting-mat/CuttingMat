import{m as a,b as s}from"./auth.19da349a.js";import{n}from"./index.528966d6.js";import"./ui.e08bd340.js";var l=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("el-form",{ref:"form",staticClass:"auth_mobile",attrs:{model:t.formData,rules:t.rules,"label-position":"left","v-loading":t.loading}},[e("el-form-item",[t._v("\u7ED1\u5B9A\u624B\u673A\uFF1A"+t._s(t.anonymousMobile))]),e("el-form-item",{attrs:{prop:"inputMobile"}},[e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u7ED1\u5B9A\u624B\u673A","prefix-icon":"el-icon-message"},model:{value:t.formData.inputMobile,callback:function(o){t.$set(t.formData,"inputMobile",o)},expression:"formData.inputMobile"}})],1),e("el-form-item",{attrs:{prop:"userInput"}},[e("el-input",{attrs:{placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},model:{value:t.formData.userInput,callback:function(o){t.$set(t.formData,"userInput",o)},expression:"formData.userInput"}},[e("countdownButton",{ref:"countdownButton",attrs:{slot:"append",count:30},on:{click:t.sendValidCode},slot:"append"},[t._v("\u83B7\u53D6\u9A8C\u8BC1\u7801")])],1)],1),e("el-form-item",[e("el-button",{staticStyle:{width:"100%"},attrs:{"native-type":"button",type:"primary"},on:{click:t.handleSubmit}},[t._v("\u7ACB\u5373\u9A8C\u8BC1")])],1)],1)},u=[];const m={data(){return{loading:!1,formData:{id:null,userInput:null,inputMobile:null},rules:{inputMobile:[{validator:(i,e,o)=>{e?(this.userMobile!==e&&o(new Error("\u90AE\u7BB1\u4E0D\u6B63\u786E")),o()):o(new Error("\u8BF7\u8F93\u5165\u7ED1\u5B9A\u624B\u673A"))}}],userInput:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",trigger:"blur"},{min:4,max:6,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u9A8C\u8BC1\u7801",trigger:"blur"}]}}},computed:{userMobile(){return String(this.$store.state.user.contactNumber)},anonymousMobile(){if(this.userMobile){const t=this.userMobile.split("");return`${t.map((e,o)=>o<3||t.length-o<3?e:"*").join("")}`}return""}},methods:{sendValidCode(){this.$refs.form.validateField("inputMobile",t=>{t||(this.loading=!0,a({mobile:this.formData.inputMobile}).then(i=>{this.loading=!1,i.status===200?(this.formData.id=i.data.id,this.$refs.countdownButton.start()):this.$message.warning("\u9A8C\u8BC1\u7801\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}).catch(()=>{this.loading=!1}))})},handleSubmit(){this.$refs.form.validateField("userInput",t=>{t||(this.loading=!0,s(this.formData).then(i=>{this.loading=!1,i.status===200?this.$emit("success",i.data):(this.$refs.form.resetFields(),this.$message.warning("\u9A8C\u8BC1\u5931\u8D25"))}).catch(()=>{this.loading=!1}))})}}},r={};var d=n(m,l,u,!1,f,"2f29e8ea",null,null);function f(t){for(let i in r)this[i]=r[i]}var _=function(){return d.exports}();export{_ as default};
